(this["webpackJsonpvoxel-edit"]=this["webpackJsonpvoxel-edit"]||[]).push([[0],{205:function(e,t,o){},210:function(e,t,o){},211:function(e,t,o){},215:function(e,t,o){},322:function(e,t,o){},327:function(e,t,o){"use strict";o.r(t);o(204),o(205);var r=o(0),n=o.n(r),i=o(59),l=o.n(i),s=(o(210),o(1)),a=o(3),c=o(4),d=o(5),u=o(183),h=(o(211),o(11)),v=function(e){Object(c.a)(o,e);var t=Object(d.a)(o);function o(e){var r;return Object(s.a)(this,o),(r=t.call(this,e)).canvasRef=n.a.createRef(),r}return Object(a.a)(o,[{key:"componentDidMount",value:function(){this.props.onCanvasCreation(this.canvasRef)}},{key:"render",value:function(){return Object(h.jsx)("canvas",{className:"viewportCanvas",ref:this.canvasRef})}}]),o}(n.a.Component),C=o(338),p=function(e){Object(c.a)(o,e);var t=Object(d.a)(o);function o(e){var r;return Object(s.a)(this,o),(r=t.call(this,e)).handleBrushClick=function(e,t){var o=t.name;r.setState({activeBrush:o}),r.props.onBrushChange(o)},r.state={activeBrush:"add"},r}return Object(a.a)(o,[{key:"componentDidMount",value:function(){this.props.onBrushChange(this.state.activeBrush)}},{key:"render",value:function(){var e=this.state.activeBrush;return Object(h.jsxs)(n.a.Fragment,{children:[Object(h.jsx)(C.a.Item,{name:"add",active:"add"===e,onClick:this.handleBrushClick,children:"Add Voxel"}),Object(h.jsx)(C.a.Item,{name:"remove",active:"remove"===e,onClick:this.handleBrushClick,children:"Remove Voxel"}),Object(h.jsx)(C.a.Item,{name:"paint",active:"paint"===e,onClick:this.handleBrushClick,children:"Paint Voxel"})]})}}]),o}(n.a.Component),f=(o(215),o(192)),b=o(80),j=function(e){var t=e.color,o=e.id,r=e.isActive,n=t.getRGB255(),i=n.r,l=n.g,s=n.b;return Object(h.jsx)("div",{onClick:function(){e.onColorCellClick(o,{r:i,g:l,b:s})},className:"color-cell ".concat(r?"active":""),style:{backgroundColor:"rgb(".concat(i,", ").concat(l,", ").concat(s,")")}})},x=function(e){Object(c.a)(o,e);var t=Object(d.a)(o);function o(e){var r;Object(s.a)(this,o),(r=t.call(this,e)).updateColorData=function(){var e=r.props.onGetColorData(),t=e.currentColor,o=e.selectedColorIndex,n=e.isColorsFull,i={};r.state.isColorsFull!==n&&(i.isColorsFull=n),r.state.selectedColorIndex!==o&&(i.selectedColorIndex=o);var l=r.state.currentColor,s=l.r,a=l.g,c=l.b;s===t.r&&a===t.g&&c===t.b||(i.currentColor=t),0!==Object.keys(i).length&&r.setState(i)},r.handlePickerChange=function(e){var t=e.rgb;r.props.onSelectedColorChange(r.state.selectedColorIndex,t),r.updateColorData()},r.onColorCellClick=function(e,t){r.props.onNewSelectedColor(e),r.updateColorData()},r.onAddCellClick=function(){r.props.onAddColor(),r.updateColorData()},r.getColorCells=function(){var e=[];return r.props.onGetColorData().colors.forEach((function(t,o){e.push(Object(h.jsx)(j,{id:o,onColorCellClick:r.onColorCellClick,color:t,isActive:o===r.state.selectedColorIndex},o))})),e},r.getAddColorCell=function(){return r.state.isColorsFull?null:Object(h.jsx)("div",{className:"color-cell add-cell-btn",onClick:r.onAddCellClick,children:Object(h.jsx)(b.a,{name:"plus"})})};var n=r.props.onGetColorData(),i=n.currentColor,l=n.selectedColorIndex,a=n.isColorsFull;return r.state={currentColor:i,selectedColorIndex:l,isColorsFull:a},r}return Object(a.a)(o,[{key:"componentDidUpdate",value:function(){this.updateColorData()}},{key:"render",value:function(){return Object(h.jsxs)("div",{children:[Object(h.jsxs)("div",{className:"color-cell-container",children:[this.getColorCells(),this.getAddColorCell()]}),Object(h.jsx)(f.a,{color:this.state.currentColor,disableAlpha:!0,onChange:this.handlePickerChange})]})}}]),o}(n.a.Component),m=(o(322),o(343)),O=o(344),g=o(340),w=o(345),y=o(346),S=o(339),k=o(341),I=function(e){Object(c.a)(o,e);var t=Object(d.a)(o);function o(e){var r;return Object(s.a)(this,o),(r=t.call(this,e)).updateMobileState=function(){var e=window.innerWidth<768;r.setState({isMobile:e})},r.handleAccordionIndicesChange=function(e,t){var o=Object(u.a)({},r.state.desktop),n=o[t].activeAccordionIndices,i=n.indexOf(e);-1!==i?n.splice(i,1):n.push(e),r.setState({desktop:o})},r.createDesktopBrush=function(){var e=r.state.desktop.brushSettings;return Object(h.jsx)(m.a.Group,{children:Object(h.jsxs)(m.a,{inverted:!0,children:[Object(h.jsxs)(O.a,{as:"h4",inverted:!0,children:[Object(h.jsx)(b.a,{name:"paint brush"}),Object(h.jsxs)(O.a.Content,{children:["Brush Settings",Object(h.jsx)(O.a.Subheader,{children:"Add, remove, or paint voxels"})]})]}),Object(h.jsxs)(g.a,{inverted:!0,fluid:!0,exclusive:!1,children:[Object(h.jsx)(g.a.Title,{active:e.activeAccordionIndices.includes(0),content:"Brush Action",index:0,onClick:function(e,t){r.handleAccordionIndicesChange(t.index,"brushSettings")}}),Object(h.jsx)(g.a.Content,{active:e.activeAccordionIndices.includes(0),children:Object(h.jsx)(C.a,{inverted:!0,vertical:!0,fluid:!0,children:Object(h.jsx)(p,{onBrushChange:r.props.onBrushChange})})})]})]})})},r.createDesktopColorPalette=function(){var e=r.state.desktop.colorPalette;return Object(h.jsx)(m.a.Group,{children:Object(h.jsxs)(m.a,{inverted:!0,children:[Object(h.jsxs)(O.a,{as:"h4",inverted:!0,children:[Object(h.jsx)(b.a,{name:"tint"}),Object(h.jsxs)(O.a.Content,{children:["Color Palette",Object(h.jsx)(O.a.Subheader,{children:"Select a color to paint with"})]})]}),Object(h.jsxs)(g.a,{inverted:!0,fluid:!0,exclusive:!1,children:[Object(h.jsx)(g.a.Title,{active:e.activeAccordionIndices.includes(0),content:"Color Selection",index:0,onClick:function(e,t){r.handleAccordionIndicesChange(t.index,"colorPalette")}}),Object(h.jsx)(g.a.Content,{active:e.activeAccordionIndices.includes(0),children:Object(h.jsx)(x,{onGetColorData:r.props.onGetColorData,onSelectedColorChange:r.props.onSelectedColorChange,onNewSelectedColor:r.props.onNewSelectedColor,onAddColor:r.props.onAddColor})})]})]})})},r.state={isMobile:!1,mobile:{isColorModalOpen:!1},desktop:{brushSettings:{activeAccordionIndices:[0]},colorPalette:{activeAccordionIndices:[0]}}},r}return Object(a.a)(o,[{key:"componentDidMount",value:function(){this.updateMobileState(),window.addEventListener("resize",this.updateMobileState)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateMobileState)}},{key:"createDesktopViewport",value:function(){return Object(h.jsxs)(w.a.Pushable,{as:m.a,style:{border:"none",borderRadius:"0"},children:[Object(h.jsxs)(w.a,{as:C.a,inverted:!0,direction:"top",visible:!0,width:"very thin",children:[Object(h.jsx)(C.a.Item,{as:"a",children:"Button 1"}),Object(h.jsx)(C.a.Item,{as:"a",children:"Button 2"})]}),Object(h.jsx)(v,{onCanvasCreation:this.props.onCanvasCreation})]})}},{key:"createDesktopGUI",value:function(){return Object(h.jsx)(y.a,{className:"desktopGrid",children:Object(h.jsxs)(y.a.Row,{children:[Object(h.jsxs)(y.a.Column,{width:3,style:{height:"100vh",overflowY:"auto",marginTop:"1em"},children:[this.createDesktopBrush(),this.createDesktopColorPalette()]}),Object(h.jsx)(y.a.Column,{width:11,style:{padding:"0"},children:this.createDesktopViewport()}),Object(h.jsx)(y.a.Column,{width:2,children:Object(h.jsx)("h1",{children:"Right Panel"})})]})})}},{key:"createMobileGUI",value:function(){var e=this;return Object(h.jsx)("div",{style:{height:window.innerHeight},children:Object(h.jsxs)(w.a.Pushable,{as:m.a,style:{border:"none",borderRadius:"0"},children:[Object(h.jsxs)(w.a,{as:C.a,inverted:!0,direction:"top",visible:!0,width:"very thin",children:[Object(h.jsx)(C.a.Item,{as:"a",onClick:function(){return e.setState({mobile:{isColorModalOpen:!0}})},children:"Color Palette"}),Object(h.jsx)(C.a.Item,{as:"a",children:"Edit"}),Object(h.jsx)(C.a.Item,{as:"a",children:"Camera"}),Object(h.jsx)(C.a.Item,{as:"a",children:"Project"})]}),Object(h.jsxs)(S.a,{open:this.state.mobile.isColorModalOpen,onClose:function(){return e.setState({mobile:{isColorModalOpen:!1}})},onOpen:function(){return e.setState({mobile:{isColorModalOpen:!0}})},children:[Object(h.jsx)(S.a.Header,{children:"Color Palette"}),Object(h.jsx)(S.a.Content,{scrolling:!0,children:Object(h.jsx)(S.a.Description,{children:Object(h.jsx)(x,{onGetColorData:this.props.onGetColorData,onSelectedColorChange:this.props.onSelectedColorChange,onNewSelectedColor:this.props.onNewSelectedColor,onAddColor:this.props.onAddColor})})}),Object(h.jsx)(S.a.Actions,{children:Object(h.jsx)(k.a,{onClick:function(){return e.setState({mobile:{isColorModalOpen:!1}})},primary:!0,children:"Close"})})]}),Object(h.jsx)(w.a,{as:C.a,inverted:!0,direction:"bottom",visible:!0,width:"thin",children:Object(h.jsx)(p,{onBrushChange:this.props.onBrushChange})}),Object(h.jsx)(v,{onCanvasCreation:this.props.onCanvasCreation})]})})}},{key:"render",value:function(){return this.state.isMobile?this.createMobileGUI():this.createDesktopGUI()}}]),o}(n.a.Component),M=o(86),A=o(12),z=o(191),R=o(79),B=function(){function e(t){Object(s.a)(this,e),this.cellSize=t.cellSize,this.tileSize=t.tileSize,this.tileTextureWidth=t.tileTextureWidth,this.tileTextureHeight=t.tileTextureHeight,this.material=t.material,this.colorPalette=t.colorPalette,this.cellSliceSize=this.cellSize*this.cellSize,this.cells=t.cells,this.cellIdToMesh={},this.neighborOffsets=[[0,0,0],[-1,0,0],[1,0,0],[0,-1,0],[0,1,0],[0,0,-1],[0,0,1]]}return Object(a.a)(e,[{key:"computeVoxelOffset",value:function(e,t,o){var r=this.cellSize,n=this.cellSliceSize,i=0|A.h.euclideanModulo(e,r);return(0|A.h.euclideanModulo(t,r))*n+(0|A.h.euclideanModulo(o,r))*r+i}},{key:"computeCellId",value:function(e,t,o){var r=this.cellSize,n=Math.floor(e/r),i=Math.floor(t/r),l=Math.floor(o/r);return"".concat(n,",").concat(i,",").concat(l)}},{key:"addCellForVoxel",value:function(e,t,o){var r=this.computeCellId(e,t,o),n=this.cells[r];if(!n){var i=this.cellSize;n=new Uint8Array(i*i*i),this.cells[r]=n}return n}},{key:"getCellForVoxel",value:function(e,t,o){return this.cells[this.computeCellId(e,t,o)]}},{key:"setVoxel",value:function(e,t,o,r){var n=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=this.getCellForVoxel(e,t,o);if(!i){if(!n)return;i=this.addCellForVoxel(e,t,o)}var l=this.computeVoxelOffset(e,t,o);i[l]=r}},{key:"getVoxel",value:function(e,t,o){var r=this.getCellForVoxel(e,t,o);return r?r[this.computeVoxelOffset(e,t,o)]:0}},{key:"generateGeometryDataForCell",value:function(t,o,r){for(var n=this.cellSize,i=this.tileSize,l=this.tileTextureWidth,s=this.tileTextureHeight,a=[],c=[],d=[],u=[],h=[],v=t*n,C=o*n,p=r*n,f=0;f<n;++f)for(var b=C+f,j=0;j<n;++j)for(var x=p+j,m=0;m<n;++m){var O=v+m,g=this.getVoxel(O,b,x);if(g){var w,y=g-1,S=Object(R.a)(e.faces);try{for(S.s();!(w=S.n()).done;){var k=w.value,I=k.dir,A=k.corners,z=k.uvRow;if(!this.getVoxel(O+I[0],b+I[1],x+I[2])){var B,D=a.length/3,P=Object(R.a)(A);try{for(P.s();!(B=P.n()).done;){var E=B.value,G=E.pos,V=E.uv;a.push(G[0]+m,G[1]+f,G[2]+j),c.push.apply(c,Object(M.a)(I)),d.push((y+V[0])*i/l,1-(z+1-V[1])*i/s);var F=this.colorPalette.getColorAtIndex(g-1);h.push(F.r,F.g,F.b)}}catch(N){P.e(N)}finally{P.f()}u.push(D,D+1,D+2,D+2,D+1,D+3)}}}catch(N){S.e(N)}finally{S.f()}}}return{positions:a,normals:c,uvs:d,indices:u,colors:h}}},{key:"intersectRay",value:function(e,t){var o=t.x-e.x,r=t.y-e.y,n=t.z-e.z,i=o*o+r*r+n*n,l=Math.sqrt(i);o/=l,r/=l,n/=l;for(var s=0,a=Math.floor(e.x),c=Math.floor(e.y),d=Math.floor(e.z),u=o>0?1:-1,h=r>0?1:-1,v=n>0?1:-1,C=Math.abs(1/o),p=Math.abs(1/r),f=Math.abs(1/n),b=u>0?a+1-e.x:e.x-a,j=h>0?c+1-e.y:e.y-c,x=v>0?d+1-e.z:e.z-d,m=C<1/0?C*b:1/0,O=p<1/0?p*j:1/0,g=f<1/0?f*x:1/0,w=-1;s<=l;){var y=this.getVoxel(a,c,d);if(y)return{position:[e.x+s*o,e.y+s*r,e.z+s*n],normal:[0===w?-u:0,1===w?-h:0,2===w?-v:0],voxel:y};m<O?m<g?(a+=u,s=m,m+=C,w=0):(d+=v,s=g,g+=f,w=2):O<g?(c+=h,s=O,O+=p,w=1):(d+=v,s=g,g+=f,w=2)}return null}},{key:"updateVoxelGeometry",value:function(e,t,o,r){var n,i={},l=Object(R.a)(this.neighborOffsets);try{for(l.s();!(n=l.n()).done;){var s=n.value,a=t+s[0],c=o+s[1],d=r+s[2],u=this.computeCellId(a,c,d);i[u]||(i[u]=!0,this.updateCellGeometry(e,a,c,d))}}catch(h){l.e(h)}finally{l.f()}}},{key:"updateCellGeometry",value:function(e,t,o,r){var n=this.cellSize,i=Math.floor(t/n),l=Math.floor(o/n),s=Math.floor(r/n),a=this.computeCellId(t,o,r),c=this.cellIdToMesh[a],d=c?c.geometry:new A.b,u=this.generateGeometryDataForCell(i,l,s),h=u.positions,v=u.normals,C=u.indices,p=u.colors;d.setAttribute("position",new A.a(new Float32Array(h),3));d.setAttribute("normal",new A.a(new Float32Array(v),3));d.setAttribute("color",new A.a(new Float32Array(p),3)),d.setIndex(C),d.computeBoundingSphere(),c||((c=new A.i(d,this.material)).name=a,this.cellIdToMesh[a]=c,e.add(c),c.position.set(i*n,l*n,s*n))}},{key:"updateWorldGeometry",value:function(e){var t=this,o=Object.keys(this.cells),r=/^(-?\d+),(-?\d+),(-?\d+)$/;o.forEach((function(o){var n=o.match(r),i=parseInt(n[1],10),l=parseInt(n[2],10),s=parseInt(n[3],10);t.updateCellGeometry(e,i*t.cellSize,l*t.cellSize,s*t.cellSize)}))}}]),e}();B.faces=[{uvRow:0,dir:[-1,0,0],corners:[{pos:[0,1,0],uv:[0,1]},{pos:[0,0,0],uv:[0,0]},{pos:[0,1,1],uv:[1,1]},{pos:[0,0,1],uv:[1,0]}]},{uvRow:0,dir:[1,0,0],corners:[{pos:[1,1,1],uv:[0,1]},{pos:[1,0,1],uv:[0,0]},{pos:[1,1,0],uv:[1,1]},{pos:[1,0,0],uv:[1,0]}]},{uvRow:1,dir:[0,-1,0],corners:[{pos:[1,0,1],uv:[1,0]},{pos:[0,0,1],uv:[0,0]},{pos:[1,0,0],uv:[1,1]},{pos:[0,0,0],uv:[0,1]}]},{uvRow:2,dir:[0,1,0],corners:[{pos:[0,1,1],uv:[1,1]},{pos:[1,1,1],uv:[0,1]},{pos:[0,1,0],uv:[1,0]},{pos:[1,1,0],uv:[0,0]}]},{uvRow:0,dir:[0,0,-1],corners:[{pos:[1,0,0],uv:[0,0]},{pos:[0,0,0],uv:[1,0]},{pos:[1,1,0],uv:[0,1]},{pos:[0,1,0],uv:[1,1]}]},{uvRow:0,dir:[0,0,1],corners:[{pos:[0,0,1],uv:[0,0]},{pos:[1,0,1],uv:[1,0]},{pos:[0,1,1],uv:[0,1]},{pos:[1,1,1],uv:[1,1]}]}];var D=B,P=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"add";Object(s.a)(this,e),this.setCurrentBrush(t)}return Object(a.a)(e,[{key:"setCurrentBrush",value:function(t){var o=e.brushOptions[t];o&&(this.currentBrush=o)}}]),e}();P.brushOptions={add:"add",remove:"remove",paint:"paint"};var E=P,G=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Object(s.a)(this,e),this.colors=t||[new V(.5176,.7843,.0902)],this.selectedColor=o,this.maxColors=128}return Object(a.a)(e,[{key:"addColor",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.isColorsFull()||(this.colors.push(new V(e,t,o)),this.selectedColor=this.colors.length-1)}},{key:"isColorsFull",value:function(){return this.colors.length>=this.maxColors}},{key:"setColorAtIndex",value:function(e,t,o,r){e<0||e>=this.colors.length||(this.colors[e].r=t,this.colors[e].g=o,this.colors[e].b=r)}},{key:"getColorAtIndex",value:function(e){return e<0||e>=this.colors.length?null:this.colors[e]}},{key:"getSelectedColor",value:function(){return this.colors[this.selectedColor]}},{key:"setSelectedColor",value:function(e){if(e<0||e>=this.colors.length)return null;this.selectedColor=e}},{key:"getSelectedColorIndex",value:function(){return this.selectedColor}},{key:"getColorsArray",value:function(){return this.colors}}]),e}(),V=function(){function e(t,o,r){Object(s.a)(this,e),this.r=t,this.g=o,this.b=r}return Object(a.a)(e,[{key:"getRGB255",value:function(){return{r:255*this.r,g:255*this.g,b:255*this.b}}}]),e}(),F=G;function N(e,t){return Math.floor(Math.random()*(t-e)+e)}var q=function(){function e(t){var o=this;Object(s.a)(this,e),this.render=function(){o.renderRequested=void 0,o.resizeRendererToDisplaySize(o.renderer)&&(o.camera.aspect=o.canvas.clientWidth/o.canvas.clientHeight,o.camera.updateProjectionMatrix()),o.controls.update(),o.renderer.render(o.scene,o.camera)},this.requestRenderIfNotRequested=function(){o.renderRequested||(o.renderRequested=!0,requestAnimationFrame(o.render))},this.recordStartPosition=function(e){var t=o.mouse;t.x=e.clientX,t.y=e.clientY,t.moveX=0,t.moveY=0},this.recordMovement=function(e){var t=o.mouse;t.moveX+=Math.abs(t.x-e.clientX),t.moveY+=Math.abs(t.y-e.clientY)},this.placeVoxelIfNoMovement=function(e){var t=o.mouse;t.moveX<5&&t.moveY<5&&o.placeVoxel(e),window.removeEventListener("pointermove",o.recordMovement),window.removeEventListener("pointerup",o.placeVoxelIfNoMovement)},this.onSelectedColorChange=function(e,t,r,n){o.world.colorPalette.setColorAtIndex(e,t,r,n),o.world.updateWorldGeometry(o.scene),o.requestRenderIfNotRequested()},this.onNewSelectedColor=function(e){o.world.colorPalette.setSelectedColor(e)},this.canvas=t.canvas,this.renderer=new A.r({canvas:this.canvas}),this.cellSize=32,this.createCamera(),this.createOrbitControls(),this.scene=new A.m,this.scene.background=new A.c("#3C3C3C"),this.addLight(-1,2,4),this.addLight(1,-1,-2);var r=new A.j({side:A.e,alphaTest:.1,transparent:!0,vertexColors:!0}),n=t.world,i=n?n.colorPalette:new F,l=n?n.cells:{};this.world=new D({cellSize:this.cellSize,tileSize:16,tileTextureWidth:256,tileTextureHeight:64,material:r,colorPalette:i,cells:l}),n||function(e,t,o,r,n){for(var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,l=t*n,s=o*n,a=r*n,c=0;c<n;++c)for(var d=0;d<n;++d)e.setVoxel(l+d,s,a+c,i||N(1,17))}(this.world,0,0,0,this.cellSize,1),this.world.updateWorldGeometry(this.scene),this.renderRequested=!1,this.mouse={x:0,y:0,moveX:0,moveY:0},this.canvas.addEventListener("pointerdown",(function(e){e.preventDefault(),o.recordStartPosition(e),window.addEventListener("pointermove",o.recordMovement),window.addEventListener("pointerup",o.placeVoxelIfNoMovement)}),{passive:!1}),this.canvas.addEventListener("touchstart",(function(e){e.preventDefault()}),{passive:!1}),this.controls.addEventListener("change",this.requestRenderIfNotRequested),window.addEventListener("resize",this.requestRenderIfNotRequested),this.brush=new E,this.render()}return Object(a.a)(e,[{key:"createCamera",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:75,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e3;this.camera=new A.k(e,t,o,r),this.camera.position.set(.2*-this.cellSize,.3*this.cellSize,.2*-this.cellSize)}},{key:"createOrbitControls",value:function(){this.controls=new z.a(this.camera,this.canvas),this.controls.target.set(this.cellSize/2,0,this.cellSize/2),this.controls.update()}},{key:"addLight",value:function(e,t,o){var r=new A.d(16777215,1);r.position.set(e,t,o),this.scene.add(r)}},{key:"resizeRendererToDisplaySize",value:function(e){var t=e.domElement,o=t.clientWidth,r=t.clientHeight,n=t.width!==o||t.height!==r;return n&&e.setSize(o,r,!1),n}},{key:"getCanvasRelativePosition",value:function(e){var t=this.canvas,o=t.getBoundingClientRect();return{x:(e.clientX-o.left)*t.width/o.width,y:(e.clientY-o.top)*t.height/o.height}}},{key:"placeVoxel",value:function(e){var t=this,o=this.getCanvasRelativePosition(e),r=o.x/this.canvas.width*2-1,n=o.y/this.canvas.height*-2+1,i=new A.q,l=new A.q;i.setFromMatrixPosition(this.camera.matrixWorld),l.set(r,n,1).unproject(this.camera);var s=this.world.intersectRay(i,l);if(s){var a,c,d=this.brush.currentBrush===E.brushOptions.remove?0:this.world.colorPalette.getSelectedColorIndex()+1,u=s.position.map((function(e,o){return e+s.normal[o]*(t.brush.currentBrush===E.brushOptions.add?.5:-.5)}));(a=this.world).setVoxel.apply(a,Object(M.a)(u).concat([d])),(c=this.world).updateVoxelGeometry.apply(c,[this.scene].concat(Object(M.a)(u))),this.requestRenderIfNotRequested()}}}]),e}(),T=function(e){Object(c.a)(o,e);var t=Object(d.a)(o);function o(e){var r;return Object(s.a)(this,o),(r=t.call(this,e)).createVoxelWorld=function(e){if(e)if(r.voxelEditor){var t=r.voxelEditor.world;r.voxelEditor=new q({canvas:e.current,world:t})}else r.voxelEditor=new q({canvas:e.current})},r.setCurrentBrush=function(e){r.voxelEditor&&r.voxelEditor.brush.setCurrentBrush(e)},r.onGetColorData=function(){if(!r.voxelEditor)return{colors:[],selectedColorIndex:0,currentColor:{r:127.5,g:127.5,b:127.5},isColorsFull:!0};var e=r.voxelEditor.world.colorPalette,t=e.getSelectedColor().getRGB255(),o=t.r,n=t.g,i=t.b;return{colors:e.getColorsArray(),selectedColorIndex:e.getSelectedColorIndex(),currentColor:{r:o,g:n,b:i},isColorsFull:e.isColorsFull()}},r.onSelectedColorChange=function(e,t){if(r.voxelEditor){var o=t.r,n=t.g,i=t.b;r.voxelEditor.onSelectedColorChange(e,o/255,n/255,i/255)}},r.onNewSelectedColor=function(e){r.voxelEditor&&r.voxelEditor.onNewSelectedColor(e)},r.onAddColor=function(){r.voxelEditor&&r.voxelEditor.world.colorPalette.addColor()},r.voxelEditor=null,r}return Object(a.a)(o,[{key:"render",value:function(){return Object(h.jsx)(I,{onCanvasCreation:this.createVoxelWorld,onBrushChange:this.setCurrentBrush,onGetColorData:this.onGetColorData,onSelectedColorChange:this.onSelectedColorChange,onNewSelectedColor:this.onNewSelectedColor,onAddColor:this.onAddColor})}}]),o}(n.a.Component),W=function(){return Object(h.jsx)(T,{})};l.a.render(Object(h.jsx)(n.a.StrictMode,{children:Object(h.jsx)(W,{})}),document.getElementById("root"))}},[[327,1,2]]]);
//# sourceMappingURL=main.d55bcb3a.chunk.js.map